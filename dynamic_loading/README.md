# 動的ローディング

ここでは、動的ローディングをする事でコンパイルせずに実行して必要なファイルのみ読み込む型システムを考えます。
Scalaは元々静的型付けな言語ですが、動的に型付け可能かどうかを考えてみましょう。
また、必要になってから読み込む事も考えます。

https://github.com/hsk/scalac_optimize/issues/1 について実装や文章をここでまとめます。

1. implicit conversionの動的解決
2. implicit parameterの動的解決
3. importの動的解決
4. importレスに動かせないか考える
5. オーバーロード

importは、動的なローディングを阻害する。なぜなら、importするには実行前に読み込みが必要だからである。
importする際には、型情報が予め決定されていると便利であるのでキャッシュされているのが望ましい。
動的な型システムでよいのであれば、動的なテーブル情報があれば済む。またパース後の構文木だけ取ってあれば十分だろう。
バイナリデータとして構文木や、シンボルテーブルを高速に保存、読み込み出来ればありがたい。

implicit conversionはクラスのプロトタイプに直接書き込む事で行う事が出来そうだ。
問題は、conversionの必要がない外部に影響が出る事だ。ローカルのクラス環境を作って参照できれば良いのかもしれない。
メソッドミッシングを引き金として、ローカルクラス環境を参照するとよいのかもしれない。

implicit parameterは型検査が必ず必要であるので、動的に解決出来ない。
動的にしたければ、構文上の工夫が必要であり、goのようなインターフェイスを使う事で解決出来るかもしれない。

オーバーロードは型によって変化するので型検査が必ず必要そうだ。Scalaは標準的にオーバーロードが可能なので型検査は必要そうだ。
しかし動的に型を見てオーバーロードは解決可能かもしれない。型クラスも同様に解決出来るのかもしれない。
